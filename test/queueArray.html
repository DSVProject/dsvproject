<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>D3 Test</title>
    <script type="text/javascript" src="d3/d3.js"></script>
    
    <style>
      circle{
        fill:white;
        stroke:black;
        stroke-width:2px;
      }
      
      .array-imp-sqr{
        fill:white;
        stroke:black;
        stroke-width:2px;
      }
      
      .array-imp-sqr-highlight{
        stroke:gold;
        stroke-width:7px;
        fill-opacity:0.0;
      }
      
      .label{
        font-family:sans-serif;
        font-size:18px;
        text-anchor:middle;
        fill:black;
      }
    </style>
  </head>
  <body>
    <div>
      <input type="text">
      <input type="button" id="btn-enqueue" onclick="findTail()" value="Enqueue">
      <input type="button" id="btn-dequeue" onclick="findHead()" value="Dequeue">
      <input type="button" id="btn-clear" onclick="" value="Clear">
      <input type="button" id="btn-resetPos" onclick="resetPos()" value="Reset Position">
    </div>
    <div id="viz"></div>
    
    <script type="text/javascript">
      
      var jsonQueue = [
        {
          "idx":0,
          "value":"A"
        }, {
          "idx":1,
          "value":"B"
        }, {
          "idx":2,
          "value":"C"
        }
      ];
    
    
      //general variables
      var width = 900,
      height = 500;
          
      var zoom = d3.behavior.zoom();
    
      // general functions
      
      // reposition g
      function rescale() {
        d3.select("#g-pan").attr("transform", "translate(" + d3.event.translate + ") scale(" + d3.event.scale + ")");
      }
      
      function resetPos() {
        d3.select("#g-pan").attr('transform', null);
        zoom.scale(1);
        zoom.translate([0, 0]);
      }
      
      // animation functions
      function findTail(){
        var highlight = d3.select("#g-rect")
          .append("rect")
          .attr("class", "array-imp-sqr-highlight")
          .attr("x", 150)
          .attr("y", 50)
          .attr("height", 50)
          .attr("width", 50)
        
        highlight.transition()            
          .delay(100)            
          .duration(3000)
          .attr("x", 50)
          .attr("y", 300)
        
        highlight.transition()
          .delay(3500)
          .duration(1000)
          .attr("x", 700)
          .delay(3800)
          .remove();
      };
      
      function findHead(){
        var highlight = d3.select("#g-rect").append("rect")
        .attr("class", "array-imp-sqr-highlight")
        .attr("x", 50)
        .attr("y", 50)
        .attr("height", 50)
        .attr("width", 50)

          
          highlight.transition()            
            .delay(100)            
            .duration(3000)
            .attr("x", 50)
            .attr("y", 300)
         .transition()
             .delay(3500)
             .duration(1000)
             .attr("x", 700)
             .delay(3800)
             .remove();
      };
      
      // layout code
      
      var arrIdx = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];
      
      var svgContainer = d3.select("#viz").append("svg")
        .attr("width", width)
        .attr("height", height)
        .attr("pointer-events", "all")
        .style("border", "1px solid black"); 
      
      // this code enables panning and zooming
      var panGroup = svgContainer.append("g")
        .call(zoom.on("zoom", rescale))
        .append("g")
        .attr("id", "g-pan");
      
      panGroup.append("rect")
        .attr('width', width)
        .attr('height', height)
        .attr('fill', 'white');
                
      
      // this groups will hold the graphic elements          
      var arrayGroup = panGroup.append("g")
        .attr("id", "g-rect");
        
      var squares = arrayGroup.selectAll("rect")
        .data(arrIdx)
        .enter()
        .append("rect");
                      
      var squaresAtt = squares                
        .attr("id", function (d) {return "array-imp-sqr-" + d; })
        .attr("class", "array-imp-sqr")
        .attr("x", function (d) {return ((d)+1) * 50;})
        .attr("y", 300)
        .attr("height", 50)
        .attr("width", 50)
        .on("mouseover", function(){d3.select(this).style("fill", "pink");})
        .on("mouseout", function(){d3.select(this).style("fill", "white");});
                        
      arrayGroup.append("rect")
        .attr("id", "array-imp-sqr-head")
        .attr("class", "array-imp-sqr")
        .attr("x", 50)
        .attr("y", 50)
        .attr("height", 50)
        .attr("width", 50);
        
      arrayGroup.append("rect")
        .attr("id", "array-imp-sqr-tail")
        .attr("class", "array-imp-sqr")
        .attr("x", 150)
        .attr("y", 50)
        .attr("height", 50)
        .attr("width", 50);
                      
      var textGroup = panGroup.append("g")
        .attr("id", "g-labels");
      
      var text = textGroup.selectAll("text")
        .data(arrIdx)
        .enter()
        .append("text");
              
      var textLabels = text
        .attr("class", "label")
        .attr("x", function (d) {return ((d+1) * 50) + 25;})
        .attr("y", 380)
        .text( function (d) { return d; });
                
      textGroup.append("text")
        .attr("class", "label")
        .attr("x", 75)
        .attr("y", 130)
        .text( "head");
        
      textGroup.append("text")
        .attr("class", "label")
        .attr("x", 175)
        .attr("y", 130)
        .text( "tail");
    
    //Stack Object  
    function FixedCapacityStack() {
      this.stack = [];
      this.cap = 15;
      this.N = 0;
      
      this.isEmpty = function() { return this.N == 0; }
      
      this.size = function() { return this.N; }
      
      this.push = function(item) { 
        if(this.N < this.cap-1) {
          this.stack[this.N] = item;
          this.N++;
        }
      }
      
      this.pop = function() {
        this.N--;
        return this.stack[this.N];
      }
      
      this.displayAll = function() { 
        var array = [];
        
        if(this.isEmpty() == true)
          return null;
        for(i=0;i<this.N;i++)
          array[i] = this.stack[i];
        return array; 
      }
    }
      
    </script>
  </body>
</html>    